!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("media-typer"),require("content-type")):"function"==typeof define&&define.amd?define(["react","media-typer","content-type"],e):(t=t||self).useAbortableFetch=e(t.react,t.mediaTyper,t.contentType)}(this,function(t,e,n){function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}return e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,function(o,u){var i=t.useState({data:null,loading:0,error:null,controller:null}),a=i[0],l=i[1],f=t.useRef(!1);return t.useLayoutEffect(function(){return f.current=!0,function(){f.current=!1}},[]),t.useEffect(function(){var t=new AbortController;return o&&function(t,o,u,i){void 0===o&&(o={});try{var a=r({},o,{signal:u.signal}),l=null;Promise.resolve(function(o,f){try{var c=(i(function(t){return{data:null,loading:t.loading+1,error:null,controller:u}}),Promise.resolve(fetch(t,a)).then(function(t){function o(){if(!l.ok){var t=new Error(l.statusText);throw t.status=l.status,t}}var u=(l=t).headers.get("content-type"),a=function(){if(u){var t=function(){i(function(t){return r({},t,{data:o,loading:t.loading-1})})},o=null,a=function(t){if(t){var r=n.parse(t),o=e.parse(r.type);if("json"===o.subtype)return!0;if("json"===o.suffix)return!0;if(o.suffix&&/\bjson\b/i.test(o.suffix))return!0;if(o.subtype&&/\bjson\b/i.test(o.subtype))return!0}return!1}(u)?Promise.resolve(l.json()).then(function(t){o=t}):Promise.resolve(l.text()).then(function(t){o=t});return a&&a.then?a.then(t):t()}i(function(t){return r({},t,{loading:t.loading-1})})}();return a&&a.then?a.then(o):o()}))}catch(t){return f(t)}return c&&c.then?c.then(void 0,f):c}(0,function(t){var e="AbortError"!==t.name?t:null;i(function(t){return r({},t,{error:e,loading:l?t.loading:t.loading-1})})}))}catch(t){return Promise.reject(t)}}(o,u,t,function(t){f.current&&l(t)}),function(){return t.abort()}},[u,o]),{data:a.data,loading:!!a.loading,error:a.error,abort:function(){return a.controller&&a.controller.abort()}}}});
//# sourceMappingURL=index.umd.js.map
