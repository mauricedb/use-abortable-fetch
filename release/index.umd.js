!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("media-typer"),require("content-type")):"function"==typeof define&&define.amd?define(["react","media-typer","content-type"],e):t.useAbortableFetch=e(t.react,t.mediaTyper,t.contentType)}(this,function(t,e,n){return e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n,"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),function(r,o){var u=t.useState({data:null,loading:0,error:null,controller:null}),i=u[0],a=u[1],l=t.useRef(!1);return t.useLayoutEffect(function(){return l.current=!0,function(){l.current=!1}},[]),t.useEffect(function(){var t=new AbortController;return r&&function(t,r,o,u){void 0===r&&(r={});try{var i=Object.assign({},r,{signal:o.signal}),a=null;Promise.resolve(function(r,l){try{var f=(u(function(t){return{data:null,loading:t.loading+1,error:null,controller:o}}),Promise.resolve(fetch(t,i)).then(function(t){function r(){if(!a.ok){var t=new Error(a.statusText);throw t.status=a.status,t}}var o=(a=t).headers.get("content-type"),i=function(){if(o){function t(){u(function(t){return Object.assign({},t,{data:r,loading:t.loading-1})})}var r=null,i=function(t){if(t){var r=n.parse(t),o=e.parse(r.type);if("json"===o.subtype)return!0;if("json"===o.suffix)return!0;if(o.suffix&&/\bjson\b/i.test(o.suffix))return!0;if(o.subtype&&/\bjson\b/i.test(o.subtype))return!0}return!1}(o)?Promise.resolve(a.json()).then(function(t){r=t}):Promise.resolve(a.text()).then(function(t){r=t});return i&&i.then?i.then(t):t()}u(function(t){return Object.assign({},t,{loading:t.loading-1})})}();return i&&i.then?i.then(r):r()}))}catch(t){return l(t)}return f&&f.then?f.then(void 0,l):f}(0,function(t){var e="AbortError"!==t.name?t:null;u(function(t){return Object.assign({},t,{error:e,loading:a?t.loading:t.loading-1})})}))}catch(t){return Promise.reject(t)}}(r,o,t,function(t){l.current&&a(t)}),function(){return t.abort()}},[o,r]),{data:i.data,loading:!!i.loading,error:i.error,abort:function(){return i.controller&&i.controller.abort()}}}});
//# sourceMappingURL=index.umd.js.map
