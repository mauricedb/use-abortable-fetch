function r(r){return r&&"object"==typeof r&&"default"in r?r.default:r}var n=require("react"),t=r(require("media-typer")),e=r(require("content-type"));function o(){return(o=Object.assign||function(r){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}return r}).apply(this,arguments)}module.exports=function(r,u){var i=n.useState({data:null,loading:0,error:null,controller:null}),a=i[0],l=i[1],f=n.useRef(!1);return n.useLayoutEffect(function(){return f.current=!0,function(){f.current=!1}},[]),n.useEffect(function(){var n=new AbortController;return r&&function(r,n,u,i){void 0===n&&(n={});try{var a=o({},n,{signal:u.signal}),l=null;Promise.resolve(function(n,f){try{var c=(i(function(r){return{data:null,loading:r.loading+1,error:null,controller:u}}),Promise.resolve(fetch(r,a)).then(function(r){function n(){if(!l.ok){var r=new Error(l.statusText);throw r.status=l.status,r}}var u=(l=r).headers.get("content-type"),a=function(){if(u){var r=function(){i(function(r){return o({},r,{data:n,loading:r.loading-1})})},n=null,a=function(r){if(r){var n=e.parse(r),o=t.parse(n.type);if("json"===o.subtype)return!0;if("json"===o.suffix)return!0;if(o.suffix&&/\bjson\b/i.test(o.suffix))return!0;if(o.subtype&&/\bjson\b/i.test(o.subtype))return!0}return!1}(u)?Promise.resolve(l.json()).then(function(r){n=r}):Promise.resolve(l.text()).then(function(r){n=r});return a&&a.then?a.then(r):r()}i(function(r){return o({},r,{loading:r.loading-1})})}();return a&&a.then?a.then(n):n()}))}catch(r){return f(r)}return c&&c.then?c.then(void 0,f):c}(0,function(r){var n="AbortError"!==r.name?r:null;i(function(r){return o({},r,{error:n,loading:l?r.loading:r.loading-1})})}))}catch(r){return Promise.reject(r)}}(r,u,n,function(r){f.current&&l(r)}),function(){return n.abort()}},[u,r]),{data:a.data,loading:!!a.loading,error:a.error,abort:function(){return a.controller&&a.controller.abort()}}};
//# sourceMappingURL=index.js.map
